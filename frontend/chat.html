<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soporte en Vivo - PyroShop</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="chat-page">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="logo">
        <span class="logo-icon">ğŸ†</span>
        <span class="logo-text">PyroShop</span>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link">Inicio</a>
        <a href="/productos.html" class="nav-link">Productos</a>
        <a href="/carrito.html" class="nav-link">ğŸ›’ Carrito</a>
        <a href="/chat.html" class="nav-link active">Soporte</a>
        <div id="nav-user-info" class="nav-user-info" style="display:none">
          <a href="/pedidos.html" id="nav-username" class="nav-username-link" title="Mis Pedidos"></a>
          <button id="btn-logout" class="btn-logout-nav">Cerrar SesiÃ³n</button>
        </div>
        <button id="btn-auth-nav" class="btn-auth">Iniciar SesiÃ³n</button>
      </div>
      <button class="mobile-menu-btn" id="mobile-menu-btn">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>

  <!-- Chat Container -->
  <div class="chat-page-container">
    <div class="container">
      
      <!-- Mensaje de bienvenida / Login requerido -->
      <div id="chat-login-required" class="chat-login-required">
        <div class="chat-welcome-box">
          <div class="chat-welcome-icon">ğŸ’¬</div>
          <h2>Chat de Soporte en Vivo</h2>
          <p>Conecta con nuestro equipo de soporte para resolver todas tus dudas sobre nuestros productos.</p>
          <p class="chat-note">âš ï¸ Debes iniciar sesiÃ³n para acceder al chat</p>
          <button id="btn-login-chat" class="btn btn-primary btn-large">Iniciar SesiÃ³n</button>
        </div>
      </div>

      <!-- Chat Main - Usuario Normal -->
      <div id="chat-user" class="chat-main-container" style="display:none">
        <div class="chat-card">
          <div class="chat-card-header">
            <div class="chat-header-info">
              <h2>ğŸ’¬ Chat de Soporte</h2>
              <span class="chat-status">ğŸŸ¢ En lÃ­nea</span>
            </div>
            <div class="chat-user-info">
              <span id="chat-username"></span>
            </div>
          </div>
          
          <div class="chat-card-body">
            <div class="chat-messages" id="chat-messages">
              <div class="chat-system-message">
                <p>ğŸ‘‹ Â¡Bienvenido al chat de soporte! Â¿En quÃ© podemos ayudarte?</p>
              </div>
            </div>
          </div>
          
          <div class="chat-card-footer">
            <form id="chat-form" class="chat-input-form">
              <input 
                type="text" 
                id="chat-input" 
                placeholder="Escribe tu mensaje..." 
                autocomplete="off"
                required
              >
              <button type="submit" class="btn-send">
                <span class="send-icon">ğŸ“¤</span>
              </button>
            </form>
          </div>
        </div>
      </div>

      <!-- Chat Admin - Vista de Conversaciones -->
      <div id="chat-admin" class="chat-admin-container" style="display:none">
        <div class="chat-admin-layout">
          
          <!-- Lista de Conversaciones -->
          <div class="conversations-sidebar">
            <div class="sidebar-header">
              <h3>ğŸ’¬ Conversaciones</h3>
              <span id="conversations-count" class="count-badge">0</span>
            </div>
            <div id="conversations-list" class="conversations-list">
              <div class="no-conversations">
                <p>ğŸ˜´ No hay conversaciones activas</p>
              </div>
            </div>
          </div>

          <!-- Ventana de Chat -->
          <div class="chat-window">
            <div id="no-conversation-selected" class="no-conversation-selected">
              <div class="empty-state">
                <div class="empty-icon">ğŸ’¬</div>
                <h3>Selecciona una conversaciÃ³n</h3>
                <p>Elige un usuario de la lista para ver y responder sus mensajes</p>
              </div>
            </div>

            <div id="active-conversation" class="active-conversation" style="display:none">
              <div class="conversation-header">
                <div class="conversation-user-info">
                  <div class="user-avatar" id="active-user-avatar">ğŸ‘¤</div>
                  <div>
                    <h3 id="active-user-name">Usuario</h3>
                    <span class="user-status" id="active-user-status">ğŸŸ¢ En lÃ­nea</span>
                  </div>
                </div>
                <button id="btn-delete-conversation" class="btn-delete-conversation" title="Eliminar conversaciÃ³n completa">
                  ğŸ—‘ï¸ Eliminar ConversaciÃ³n
                </button>
              </div>

              <div class="conversation-messages" id="conversation-messages">
                <!-- Mensajes se cargarÃ¡n aquÃ­ -->
              </div>

              <div class="conversation-input">
                <form id="admin-chat-form" class="chat-input-form">
                  <input 
                    type="text" 
                    id="admin-chat-input" 
                    placeholder="Escribe tu respuesta..." 
                    autocomplete="off"
                    required
                  >
                  <button type="submit" class="btn-send">
                    <span class="send-icon">ğŸ“¤</span>
                  </button>
                </form>
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>

  <!-- Modal de Login/Registro -->
  <div id="auth-modal" class="modal">
    <div class="modal-content">
      <span class="modal-close" id="close-auth-modal">&times;</span>
      <div class="auth-box">
        <h2>Acceso de Usuario</h2>
        
        <!-- Tabs Login/Registro -->
        <div class="auth-tabs">
          <button class="auth-tab active" id="tab-login">Iniciar SesiÃ³n</button>
          <button class="auth-tab" id="tab-register">Registrarse</button>
        </div>

        <!-- Formulario Login -->
        <form id="form-login" class="auth-form">
          <input type="text" id="login-username" placeholder="Usuario" required>
          <input type="password" id="login-password" placeholder="ContraseÃ±a" required>
          <button type="submit" class="btn btn-primary">Iniciar SesiÃ³n</button>
        </form>

        <!-- Formulario Registro -->
        <form id="form-register" class="auth-form" style="display:none">
          <input type="text" id="register-username" placeholder="Usuario" required>
          <input type="password" id="register-password" placeholder="ContraseÃ±a" required>
          <button type="submit" class="btn btn-primary">Registrarse</button>
        </form>

        <div id="auth-mensaje" class="mensaje"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3><span class="logo-icon">ğŸ†</span> PyroShop</h3>
          <p>Tu tienda de confianza para fuegos artificiales.</p>
        </div>
        <div class="footer-section">
          <h4>Enlaces</h4>
          <ul>
            <li><a href="/">Inicio</a></li>
            <li><a href="/productos.html">Productos</a></li>
            <li><a href="/chat.html">Soporte</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 PyroShop. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>

  <script src="/socket.io/socket.io.js"></script>
  <script src="chat-page.js"></script>
</body>
</html>
